


                    <!-- Control Buttons -->
                    <div id="ControlButtons" class="button-group"
                        style="display: flex; gap: 16px; justify-content: center; margin-top: 10px; margin-bottom: 20px; flex-wrap: wrap;">


                        <button id="startButton" onclick="startdesign()"
                            class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect"
                            style="background-color: #f5151500; min-width: 1px; width: 1px; height: 1px; padding: 0; border-color: #99999900; color: #e0e0e000;"
                            hidden>

                        </button>

                        <button id="endCallButton" onclick="endCallDesign()"
                            class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect"
                            style="background-color: #f5151500; min-width: 1px; width: 1px; height: 1px; padding: 0; border-color: #99999900; color: #e0e0e000; display: none;">

                        </button>


                        <button id="micToggleButton" onclick="togglemicDesign()"
                            class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect"
                            style="background-color: #e0e0e0; min-width: 60px; width: 60px; height: 60px; padding: 0;">
                            <i class="material-icons" id="micIcon">mic</i>
                        </button>

                        <button id="videoToggleButton" onclick="toggleVideoDesign()"
                            class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect"
                            style="background-color: #e0e0e0; min-width: 60px; width: 60px; height: 60px; padding: 0;">
                            <i class="material-icons" id="videoIcon">videocam</i>
                        </button>

                        <button id="summaryButton" onclick="generateInterviewSummary()"
                            class="mdl-button mdl-js-button mdl-button--fab mdl-js-ripple-effect"
                            style="background-color: #4CAF50; min-width: 60px; width: 60px; height: 60px; padding: 0;">
                            <i class="material-icons" style="color: white;">summarize</i>
                        </button>






                    </div>

                    <div class="mdl-textfield mdl-js-textfield mdl-textfield--floating-label" hidden>
                        <select class="mdl-textfield__input" id="languageSelect">
                            <option value="fr-FR">French</option>
                            <option value="en-US">English</option>
                            <option value="es-ES">Spanish</option>
                            <option value="de-DE">German</option>
                            <option value="ar-SA">Arabic</option>
                        </select>
                        <label class="mdl-textfield__label" for="languageSelect">Select Language</label>
                    </div>
                    <script>

                        // Start audio input on after 2 seconds of page load
                        setTimeout(() => {
                            document.getElementById("startButton").click();
                        }, 2000);

                        startdesign = () => {
                            console.log("Start Speaking");
                            document.getElementById("startButton").style.display = "none";
                        }

                        // // on load start the call
                        // window.onload = () => {
                        //     startdesign();

                        //     document.getElementById("videoElement").style.display = "flex";
                        //     document.getElementById("blackScreen").style.display = "none";
                        //     document.getElementById("aiContainer").style.display = "flex";
                        // }


                        togglemicDesign = () => {
                            console.log("Toggle Mic");
                            const micIcon = document.getElementById("micIcon");
                            const micToggleButton = document.getElementById("micToggleButton");
                            if (micIcon.innerText === "mic") {
                                micIcon.innerText = "mic_off";
                                micToggleButton.style.backgroundColor = "#f44336"; // Red color
                            } else {
                                micIcon.innerText = "mic";
                                micToggleButton.style.backgroundColor = "#e0e0e0"; // Normal color
                            }
                        }

                        toggleVideoDesign = () => {
                            console.log("Toggle Video");
                            const videoElement = document.getElementById("videoElement");
                            const blackScreen = document.getElementById("blackScreen");
                            if (videoElement.style.display === "flex") {
                                videoElement.style.display = "none";
                                blackScreen.style.display = "flex";
                                document.getElementById("videoIcon").innerText = "videocam_off";
                                // make it red
                                // document.getElementById("videoIcon").style.backgroundColor = "#f44336";
                                document.getElementById("videoToggleButton").style.backgroundColor = "#f44336";
                            } else {
                                videoElement.style.display = "flex";
                                blackScreen.style.display = "none";
                                document.getElementById("videoIcon").innerText = "videocam";
                                // make it back to normal
                                // document.getElementById("videoIcon").style.backgroundColor = "#e0e0e0";
                                document.getElementById("videoToggleButton").style.backgroundColor = "#e0e0e0";
                            }
                        }


                        // endCallDesign = () => {
                        //     console.log("End Call");
                        //     const videoElement = document.getElementById("videoElement");
                        //     const blackScreen = document.getElementById("blackScreen");
                        //     const ai = document.getElementById("aiContainer");
                        //     const videoToggleText = document.getElementById("videoToggleText");
                        //     const chatLog = document.getElementById("chatLog");
                        //     const control = document.getElementById("ControlButtons");

                        //     videoElement.style.display = "none";
                        //     ai.style.display = "none";
                        //     blackScreen.style.display = "none";
                        //     chatLog.innerHTML = ""; // Clear chat log
                        //     control.style.display = "none"; // Hide control buttons

                        //     // close the website
                        //     window.close();

                        // }

                    </script>



                    <!-- Hidden Canvas -->
                    <canvas id="canvasElement"></canvas>
                    <!-- Text Output -->
                    <div id="chatLog"></div>
                </div>
            </div>
        </main>
    </div>

    <script defer>
        const URL = "ws://localhost:9080";
        const video = document.getElementById("videoElement");
        const canvas = document.getElementById("canvasElement");
        const context = canvas.getContext("2d");
        const startButton = document.getElementById('startButton');
        const stopButton = document.getElementById('endCallButton');

        let stream = null;
        let currentFrameB64;
        let webSocket = null;
        let audioContext = null;
        let mediaRecorder = null;
        let processor = null;
        let pcmData = [];
        let interval = null;
        let initialized = false;
        let audioInputContext;
        let workletNode;

        // Transcription storage
        let userTranscriptions = [];
        let aiTranscriptions = [];
        let interviewStartTime = null;

        // Speech recognition for user transcription
        let recognition = null;
        let isListening = false;

        // Function to start the webcam
        async function startWebcam() {
            try {
                const constraints = {
                    video: {
                        width: {
                            max: 640
                        },
                        height: {
                            max: 480
                        },
                    },
                };

                stream = await navigator.mediaDevices.getUserMedia(constraints);
                video.srcObject = stream;
            } catch (err) {
                console.error("Error accessing the webcam: ", err);
            }
        }

        // Function to capture an image and convert it to base64
        function captureImage() {
            if (stream) {